---
title: "SQANTI3 OUTPUT COMPARISON REPORT"
author: "`r paste0('  ','Author', ': ',Sys.getenv('USERNAME'))`"
date: "`r paste0('  ','Date', ': ', format(Sys.time(), '%d %B %Y'))`"
output:
  html_document:
    number_sections: false
    toc: true
    toc_float: true
    toc_depth: 3
    theme: spacelab
---

<!-- Basic setting -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, cache = FALSE, echo = FALSE)
venn <- FALSE
```

<!-- Summary generation -->

## Summary table {.tabset .tabset-fade}

### SQANTI3 output

```{r}
t1.1
```

### Unique tag

```{r}
t1.2
```

<!-- Plot generation -->

## Gene characterization {.tabset .tabset-fade}

### Isoforms per gene

```{r}
p1.1
```

### Exon structure

```{r}
p1.2
```


## Structural category distribution

```{r}
p2
```

<!-- ADD ## Splice Junction Characterization -->

## TTS and TSS distances {.tabset .tabset-fade}

### Distance to TSS {.tabset .tabset-fade .tabset-dropdown}

#### FSM

```{r}
p4.1
```

#### ISM

```{r}
p4.2
```

### Distance to TTS {.tabset .tabset-fade .tabset-dropdown}

#### FSM

```{r}
p5.1
```

#### ISM

```{r}
p5.2
```

## CAGE peak distance {.tabset .tabset-fade .tabset-dropdown}

### FSM

```{r}
p6.1
```

### ISM

```{r}
p6.2
```

## Features of bad quality {.tabset .tabset-fade}

### RT-switching {.tabset .tabset-fade .tabset-dropdown}

#### FSM

```{r}
p7.1.1
```

#### NIC

```{r}
p7.1.2
```

#### NNC

```{r}
p7.1.3
```

<!-- ADD ## Features of good quality -->

## Complete comparison {.tabset .tabset-fade}

<!-- Print or not Venn Diagrams -->

```{r}
if (length(f_in) < 4) {
  venn<-TRUE
  asis_output("### Venn Diagrams\\n") # Header
  }
```

```{r, eval=venn}
p9
```

### UpSet plot

```{r}
p10
grid.text("All isoforms",x = 0.65, y=0.95, gp=gpar(fontsize=20))
```

<!-- By structural category -->

## Comparison by structural category

<!-- Print or not Venn Diagrams -->

```{r, results='asis'}
if (length(f_in) < 4) {
  venn<-TRUE
  cat("\n\n###  Venn Diagrams {.tabset .tabset-pills}\n") # Header
  }
```

```{r, eval=venn, results='asis'}
for (i in 1:length(p11)){
  cat("\n\n#### ", str_cat[i],"\n")
  print(p11[i])
}
```

### UpSet plot {.tabset .tabset-fade}

```{r, results='asis'}
for (i in 1:length(p12)){
  cat("\n\n#### ", str_cat[i],"\n")
  print(p12[i])
  grid.text(str_cat[i],x = 0.65, y=0.95, gp=gpar(fontsize=20))
}
```

## Standard deviation and Entropy {.tabset .tabset-fade}

### Standard deviation {.tabset .tabset-fade .tabset-dropdown}

#### TSS

```{r}
p13
```

#### TTS

```{r}
p14
```

### Entropy {.tabset .tabset-fade .tabset-dropdown}

#### TSS

```{r}
p15
```

#### TTS

```{r}
p16
```

## Presence/Ausence table

```{r}
t2
```

## SessionInfo

```{r}
sessionInfo()
```
